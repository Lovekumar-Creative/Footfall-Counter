<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Footfall Counter & Trajectory Visualizer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: white;
      font-family: 'Poppins', sans-serif;
      text-align: center;
      padding-top: 30px;
    }
    h1 {
      color: #38bdf8;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(56, 189, 248, 0.7);
    }
    .video-container {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    img {
      width: 80%;
      border-radius: 15px;
      border: 3px solid #38bdf8;
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.6);
    }
    .btn-custom {
      margin: 10px;
      font-size: 1.1rem;
      padding: 10px 25px;
      border-radius: 50px;
      border: none;
      transition: 0.3s;
      box-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
    }
    .btn-play { background-color: #22c55e; color: white; }
    .btn-play:hover { background-color: #16a34a; transform: scale(1.05); }
    .btn-stop { background-color: #ef4444; color: white; }
    .btn-stop:hover { background-color: #dc2626; transform: scale(1.05); }
    .btn-restart { background-color: #f59e0b; color: white; }
    .btn-restart:hover { background-color: #d97706; transform: scale(1.05); }
    .btn-toggle { background-color: #3b82f6; color: white; }
    .btn-toggle:hover { background-color: #2563eb; transform: scale(1.05); }
    .btn-download { background-color: #9333ea; color: white; }
    .btn-download:hover { background-color: #7e22ce; transform: scale(1.05); }
  </style>
</head>
<body>
  <h1>üé• Footfall Counter & Trajectory Visualizer</h1>
  <p>Auto-plays on load ‚Äî you can pause, restart, and toggle between real and heatmap view</p>

  <div class="d-flex justify-content-center flex-wrap">
    <button class="btn-custom btn-stop" onclick="pauseVideo()">‚è∏ Pause</button>
    <button class="btn-custom btn-restart" onclick="restartVideo()">üîÅ Restart</button>
    <button class="btn-custom btn-toggle" id="toggleViewBtn" onclick="toggleView()">üî• Switch to Heatmap</button>
    <a href="/download" class="btn-custom btn-download">‚¨á Download Video</a>
  </div>

  <div class="video-container">
    <img id="videoFeed" src="/video_feed" alt="Video stream will appear here">
  </div>

  <script>
    const videoFeed = document.getElementById('videoFeed');
    let currentView = 'real';

    function pauseVideo() {
      fetch('/pause', { method: 'POST' });
      videoFeed.src = '';
    }

    function restartVideo() {
      fetch('/restart', { method: 'POST' });
      videoFeed.src = '/video_feed';
    }

    function toggleView() {
      fetch('/toggle_view', { method: 'POST' })
        .then(res => res.text())
        .then(mode => {
          currentView = mode;
          document.getElementById('toggleViewBtn').innerText =
            mode === 'heatmap' ? 'üßç Switch to Real View' : 'üî• Switch to Heatmap';
        });
    }

    // Auto-start video when page loads
    window.onload = () => {
      fetch('/play', { method: 'POST' });
      videoFeed.src = '/video_feed';
    };
  </script>
</body>
</html>
